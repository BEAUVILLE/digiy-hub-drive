<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>DIGIY ‚ôæÔ∏è ‚Äî Missions</title>
  <meta name="theme-color" content="#16a34a"/>
  <meta name="description" content="Missions terrain DIGIY ‚Äî mise en relation directe, 0% commission." />

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --green:#16a34a; --bg:#061b14; --card:#0b2a1f;
      --line:rgba(255,255,255,.14); --text:#eafff1; --muted:rgba(234,255,241,.78);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      background:radial-gradient(900px 500px at 10% -10%, rgba(34,197,94,.20), transparent 60%), var(--bg);
      color:var(--text);
    }
    header{padding:18px 16px 12px; text-align:center; border-bottom:1px solid var(--line);}
    .brand{font-weight:950; letter-spacing:.12em}
    main{max-width:760px; margin:0 auto; padding:14px}
    .info-box{
      background:#ecfdf5; color:#065f46; border:1px solid #bbf7d0;
      border-radius:14px; padding:12px; font-size:14px; font-weight:700; margin-bottom:14px;
    }
    .card{
      background:rgba(255,255,255,.06); border:1px solid var(--line);
      border-radius:var(--radius); padding:14px; margin-bottom:12px;
    }
    .title{font-weight:950; font-size:18px}
    .meta{font-size:13px; color:var(--muted); margin-top:6px}
    .btn{
      display:inline-block; margin-top:10px; padding:12px 14px;
      border-radius:14px; border:1px solid var(--line);
      background:linear-gradient(135deg,#16a34a,#22c55e);
      color:#052e16; font-weight:950; text-decoration:none;
    }
    footer{padding:16px; text-align:center; font-size:12px; color:var(--muted)}
    a{color:#86efac; text-decoration:none; font-weight:900}
  </style>
</head>

<body>
<header>
  <div class="brand">‚ôæÔ∏è DIGIY ‚Äî MISSIONS</div>
</header>

<main>
  <div class="info-box">
    <strong>‚ÑπÔ∏è Fonctionnement</strong><br>
    DIGIY met en relation les personnes.<br>
    Le paiement et les modalit√©s se font <strong>directement entre les deux parties</strong>
    (WhatsApp, esp√®ces, Wave, Orange Money, etc.).<br>
    <strong>DIGIY ne prend aucune commission.</strong>
  </div>

  <div id="list"></div>
</main>

<footer>
  DIGIYLYFE ‚ôæÔ∏è ‚Äî direct au peuple ‚Ä¢ 0% commission ‚Ä¢
  <a href="index.html">Retour HUB</a>
</footer>

<script>
const SUPABASE_URL = "https://wesqmwjjtsefyjnluosj.supabase.co";
const SUPABASE_ANON_KEY = "TON_ANON_KEY_ICI";
const SB = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

function wa(m){
  const msg = `Bonjour, je vous contacte via DIGIY pour la mission : ${m.title}`;
  return `https://wa.me/${m.phone}?text=${encodeURIComponent(msg)}`;
}

async function load(){
  const { data, error } = await SB
    .from("jef_missions")
    .select("*")
    .eq("status","approved")
    .order("created_at",{ascending:false});

  const box = document.getElementById("list");
  if(error){ box.innerHTML = "Erreur de chargement"; return; }
  if(!data.length){ box.innerHTML = "Aucune mission pour le moment."; return; }

  box.innerHTML = data.map(m=>`
    <div class="card">
      <div class="title">${m.title}</div>
      <div class="meta">üìç ${m.zone} ‚Ä¢ ‚è±Ô∏è ${m.when || "‚Äî"}</div>
      ${m.details ? `<div class="meta">${m.details}</div>` : ``}
      <a class="btn" target="_blank" rel="noopener" href="${wa(m)}">üí¨ Contacter sur WhatsApp</a>
    </div>
  `).join("");
}
load();
</script>
</body>
</html>

